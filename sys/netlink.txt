# Copyright 2015 syzkaller project authors. All rights reserved.
# Use of this source code is governed by Apache 2 LICENSE that can be found in the LICENSE file.

include <uapi/linux/netlink.h>

socket$netlink(domain const[AF_NETLINK], type flags[netlink_type], proto const[0]) fd[netlink]
bind$netlink(fd fd[netlink], addr ptr[in, sockaddr_nl], addrlen len[addr])
connect$netlink(fd fd[netlink], addr ptr[in, sockaddr_nl], addrlen len[addr])
getsockname$netlink(fd fd[netlink], addr ptr[out, sockaddr_nl], addrlen ptr[inout, len[addr, int32]])
getpeername$netlink(fd fd[netlink], peer ptr[out, sockaddr_nl], peerlen ptr[inout, len[peer, int32]])

#	.setsockopt =	netlink_setsockopt,
#	.getsockopt =	netlink_getsockopt,
#	.sendmsg =	netlink_sendmsg,
#	.recvmsg =	netlink_recvmsg,

netlink_type = SOCK_RAW, SOCK_DGRAM
netlink_family = AF_NETLINK, AF_UNSPEC

sockaddr_nl {
	family	flags[netlink_family, int16]
	pad	const[0, int16]
	pid	int32
	groups	int32
}

